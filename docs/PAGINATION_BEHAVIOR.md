# 商品選択モーダルのページネーション動作

## 概要

商品選択モーダルでは、`PaginatedListContainer`コンポーネントを使用してページネーションを実装しています。

## ページネーションの設定

### 基本設定

- **1ページあたりの表示数**: 24件（`itemsPerPage: 24`）
- **ページネーションコントロールの表示位置**: ヘッダーとフッターの両方（`paginationPosition="both"`）
- **ページネーションの有効化**: 有効（`enabled: true`）

### ページネーションコントロール

ヘッダーとフッターに以下のコントロールが表示されます：

- **最初のページへ**（`<<`）: 1ページ目に移動
- **前のページへ**（`<`）: 前のページに移動
- **現在のページ / 総ページ数**: 例: `2 / 5`
- **次のページへ**（`>`）: 次のページに移動
- **最後のページへ**（`>>`）: 最後のページに移動
- **表示件数**: 例: `25 - 48 / 120件`

## メーカー切り替え時の動作

### 1. メーカードロップダウンで切り替え

```typescript
<select
    value={selectedManufacturer}
    onChange={(e) => {
        setSelectedManufacturer(e.target.value);
        setSelectedProduct(null); // メーカー変更時は商品選択をリセット
    }}
>
```

### 2. データの再読み込み

`selectedManufacturer`が変更されると：

1. **データ読み込み**: 選択されたメーカーのテーブルを読み込む（まだ読み込まれていない場合）
2. **商品データの再計算**: `productsForCardDisplay`が再計算される
3. **フィルタリング**: `filteredData`が再計算される
4. **ページネーション**: データが変更されたため、**自動的に1ページ目にリセット**

### 3. ページのリセット

`PaginatedListContainer`では、データの長さが変更されると自動的に1ページ目にリセットされます：

```typescript
useEffect(() => {
    // データの長さが変更された場合（メーカー切り替えなど）はページをリセット
    setCurrentPage(1);
}, [data.length]);
```

## ページネーションの計算

### ページネーション計算式

```typescript
const totalPages = Math.ceil(data.length / itemsPerPage);
const startIndex = (currentPage - 1) * itemsPerPage;
const endIndex = Math.min(startIndex + itemsPerPage, data.length);
const paginatedData = data.slice(startIndex, endIndex);
```

### 例

- **総商品数**: 120件
- **1ページあたりの表示数**: 24件
- **総ページ数**: `Math.ceil(120 / 24) = 5ページ`

| ページ | 開始インデックス | 終了インデックス | 表示される商品 |
|--------|----------------|----------------|--------------|
| 1 | 0 | 24 | 1-24件目 |
| 2 | 24 | 48 | 25-48件目 |
| 3 | 48 | 72 | 49-72件目 |
| 4 | 72 | 96 | 73-96件目 |
| 5 | 96 | 120 | 97-120件目 |

## フィルタリングとの連携

### 検索・フィルタリング時の動作

1. **検索語入力**: `searchTerm`が変更されると`filteredData`が再計算される
2. **ブランドフィルタ**: `selectedBrand`が変更されると`filteredData`が再計算される
3. **カテゴリフィルタ**: `selectedCategory`が変更されると`filteredData`が再計算される
4. **ページリセット**: `filteredData`の長さが変更されると、自動的に1ページ目にリセット

### メーカー切り替え時のフィルタリセット

メーカーを切り替えると、ブランドフィルタも自動的にリセットされます：

```typescript
useEffect(() => {
    if (selectedManufacturer) {
        setSelectedBrand('all'); // ブランドフィルタをリセット
    }
}, [selectedManufacturer]);
```

## 表示される情報

### ヘッダー

- **検索バー**: 商品名、品番、説明、ブランド、メーカーIDで検索
- **フィルタ**: メーカー、ブランド、カテゴリで絞り込み
- **商品件数**: `{paginationInfo.totalItems}件の商品が見つかりました`
- **ページネーションコントロール**: ページ移動ボタンと現在のページ情報

### フッター

- **ページネーションコントロール**: ページ移動ボタンと現在のページ情報

## まとめ

- **1ページあたり24件表示**
- **メーカー切り替え時に自動的に1ページ目にリセット**
- **検索・フィルタリング時も自動的に1ページ目にリセット**
- **ヘッダーとフッターの両方にページネーションコントロールを表示**

これにより、メーカーを切り替えても正しく商品が表示されます。

