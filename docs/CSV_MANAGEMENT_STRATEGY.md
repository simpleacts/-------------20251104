# CSVファイル管理戦略

## 現状の問題点

### 1. 統合ファイルの更新について

現在の実装では：
- メーカーごとのファイルを読み込む
- その後、統合ファイル（`templates/sizes.csv`, `templates/product_colors.csv`）も読み込む
- 重複を除去して統合

**問題点：**
1. 統合ファイルが手動更新されない場合、新しいメーカーのデータが反映されない
2. 二重管理になり、メーカーごとのファイルと統合ファイルの間で矛盾が生じる可能性がある
3. 100件程度であればパフォーマンス的には問題ないが、管理の観点から問題がある

### 2. パフォーマンス

- **100件程度**: パフォーマンス的には問題なし
- **1000件以上**: やや重くなる可能性があるが、現時点では問題なし

## 推奨される管理戦略

### オプション1: 統合ファイルを削除（実装済み）

**方針：**
- 統合ファイルは削除済み
- メーカーごとのファイルのみを使用
- メーカーごとのファイルのみを管理対象とする

**メリット：**
- 管理がシンプル
- 二重管理の問題を回避
- メーカーごとの管理が明確

**実装：**
- 統合ファイルの読み込みを警告付きにする
- 統合ファイルが存在する場合は、コンソールに警告を表示

### オプション2: 統合ファイルを自動生成する

**方針：**
- メーカーごとのファイルから統合ファイルを自動生成
- CSVエクスポート機能で統合ファイルも出力する

**メリット：**
- 統合ファイルが常に最新の状態になる
- 既存のワークフローとの互換性を保つ

**デメリット：**
- 実装が複雑になる
- 統合ファイルが自動生成されるため、手動編集ができない

## 推奨実装：オプション1（統合ファイルを非推奨）

### 実装内容

1. **統合ファイルの読み込み時に警告を表示**
   ```typescript
   // 統合ファイルが存在する場合は警告
   if (response.ok) {
       console.warn(
           `[DEPRECATED] Unified file '${tableName}.csv' found. ` +
           `Please use manufacturer-specific files in 'templates/manufacturers/{manufacturer_id}/' instead. ` +
           `The unified file will be ignored in future versions.`
       );
   }
   ```

2. **統合ファイルの読み込みを後で削除できるようにする**
   - 将来的に統合ファイルの読み込みを削除する
   - 移行期間として、警告付きで読み込む

3. **ドキュメントで明確に方針を記載**
   - 統合ファイルは更新しない
   - メーカーごとのファイルのみを管理対象とする

## 質問への回答

### Q1: 100件くらいになっても大丈夫ですか？

**A:** はい、パフォーマンス的には問題ありません。ただし、管理の観点から統合ファイルの扱いを明確にする必要があります。

### Q2: 統合ファイルは随時更新されるんですか？

**A:** **現在の実装では、統合ファイルは更新されません。** 統合ファイルは後方互換性のためにのみ存在し、メーカーごとのファイルのみを管理対象とすることを推奨します。

## 次のステップ

1. ✅ 統合ファイルの読み込み時に警告を追加
2. ✅ ドキュメントで方針を明確化
3. 将来的に統合ファイルの読み込みを削除（移行期間を設ける）

