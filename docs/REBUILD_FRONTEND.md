# フロントエンドの再ビルド手順

## エラーの原因

`npm run build`を実行すると、以下のエラーが発生する場合があります：

```
EBUSY: resource busy or locked, rmdir 'C:\Users\...\dist'
```

このエラーは、PHP開発サーバーが`dist`ディレクトリを使用中であることが原因です。

## 解決手順

### ステップ1: PHP開発サーバーを停止

現在実行中のPHP開発サーバーを停止します：

1. **PowerShell/コマンドプロンプトで実行中のサーバーを停止**
   - サーバーが実行中のウィンドウで `Ctrl + C` を押す
   - または、サーバーが別ウィンドウで起動している場合は、そのウィンドウを閉じる

2. **ポートが使用中か確認（オプション）**
   ```powershell
   netstat -ano | findstr :8080
   ```
   何も表示されなければ、ポートは使用されていません。

### ステップ2: フロントエンドをビルド

サーバーを停止したら、フロントエンドを再ビルドします：

**推奨方法: バッチファイルを使用**
```powershell
build.bat
```

このバッチファイルは以下を自動実行します：
1. 実行ポリシーの設定（確認プロンプトを自動処理）
2. `npm install`（依存関係のインストール）
3. `npm run build`（アプリケーションのビルド）

**エラーチェック付きビルド（推奨）**
```powershell
build-with-check.bat
```

このバッチファイルは、通常のビルドに加えて以下も実行します：
- TypeScriptの構文チェック
- SQLファイルの存在確認
- エラーパターンの解析と対処法の提示

**手動で実行する場合**
```powershell
npm run build
```

ビルドが完了すると、`dist`ディレクトリに最新のファイルが生成されます。

### ステップ3: PHP開発サーバーを再起動

ビルドが完了したら、`dist`ディレクトリをドキュメントルートとしてPHP開発サーバーを起動します：

**方法1: コマンドで起動**
```powershell
php -S localhost:8080 -t dist
```

**方法2: スクリプトを使用**
```powershell
scripts\start-dist-server.bat
```

### ステップ4: ブラウザで確認

以下のURLでアプリケーションにアクセス：

```
http://localhost:8080
```

## まとめ

1. **停止**: PHP開発サーバーを停止（`Ctrl + C`）
2. **ビルド**: `npm run build`を実行
3. **起動**: `php -S localhost:8080 -t dist`で再起動
4. **確認**: ブラウザで`http://localhost:8080`にアクセス

## 注意事項

- ビルド中は`dist`ディレクトリがロックされるため、必ずサーバーを停止してからビルドしてください
- ビルド後は必ず`-t dist`オプションを指定して、`dist`ディレクトリをドキュメントルートとして起動してください
- 開発中にコードを変更した場合は、再度ビルドが必要です

